<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>SegmentStream documentation : Настройки проекта</title>
        <meta name="description" content="">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/favicon/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/favicon/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/favicon/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/favicon/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/favicon/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/favicon/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/favicon/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="/favicon/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="/favicon/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="&nbsp;"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="/favicon/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="/favicon/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="/favicon/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="/favicon/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="/favicon/mstile-310x310.png" />

        <!-- <link rel="shortcut icon" type="image/x-icon" href="/favicon/favicon.ico"> -->
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/syntax.css">
        <link rel="stylesheet" href="/css/main.css?v=1.1">
        <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <script src="/js/main.js?v=1.1"></script>
    </head>
    <body>

        <div class="container">
            <div class="row">
                <div id="header" class="col-sm-12">
                    <div class="row">
    <div class="col-sm-3 col-xs-12">
        <div id="menu-toggle"></div>
        <a target="_blank" href="https://admin.segmentstream.com/"><div id="login-button"></div></a>
        <a class="brand" href="/"><img src="/img/segmentstream-logo.png" height="47" alt=SegmentStream documentation
                class="ddm-logo">
        </a>
        <small></small>
    </div>

    <div class="col-sm-offset-5 col-sm-4 authorization">
        <ul class="top-nav">
            <li>
                <a id="button-auth" target="_blank" href="https://admin.segmentstream.com/">
                    
                    Войти
                    
                </a>
            </li>
        </ul>
    </div>
        
            <a id="language-button" href='/'>EN</a>
        
</div>


                </div>
            </div>
            <div class="row">
                
                
                    <div id="navigation" class="col-sm-3 col-md-3">
                        <ul class="nav nav-list" >
    
    
        
        
        
        
        
        
    
        
        
        
        
        
        
    
        
        
        
        
        
        
    
        
        
        
        
        
        
    
        
        
        
        
        
        
    
        
        
        
        
        
        
    
        
        
        
        
        
            <li class="nav-header analystRU ">Аналитику</li>
            
                <li class="drop-menu analystRU " data-order="0">
                    <a href="/ru/for-analyst/index">Обзор</a>
                </li>
            
                <li class="drop-menu analystRU  current " data-order="1">
                    <a href="/ru/for-analyst/settings">Настройки проекта</a>
                </li>
            
                <li class="drop-menu analystRU " data-order="2">
                    <a href="/ru/for-analyst/events">События</a>
                </li>
            
                <li class="drop-menu analystRU " data-order="2">
                    <a href="/ru/for-analyst/integrations">Интеграции</a>
                </li>
            
                <li class="drop-menu analystRU " data-order="4">
                    <a href="/ru/for-analyst/variables">Переменные</a>
                </li>
            
                <li class="drop-menu analystRU " data-order="5">
                    <a href="/ru/for-analyst/scripts">Скрипты</a>
                </li>
            
                <li class="drop-menu analystRU " data-order="6">
                    <a href="/ru/for-analyst/priorities">Приоритеты</a>
                </li>
            
        
        
    
        
        
        
        
        
            <li class="nav-header developerRU ">Разработчику</li>
            
                <li class="drop-menu developerRU " data-order="1">
                    <a href="/ru/for-developer/index">Обзор</a>
                </li>
            
                <li class="drop-menu developerRU " data-order="2">
                    <a href="/ru/for-developer/digitaldata">Объект digitalData</a>
                </li>
            
                <li class="drop-menu developerRU " data-order="2">
                    <a href="/ru/for-developer/partners">События партнерских систем</a>
                </li>
            
                <li class="drop-menu developerRU " data-order="3">
                    <a href="/ru/for-developer/naming">Правила именования переменных и событий</a>
                </li>
            
                <li class="drop-menu developerRU " data-order="3">
                    <a href="/ru/for-developer/snippet">Подключение SegmentStream</a>
                </li>
            
        
        
    
        
        
        
        
        
            <li class="nav-header ecommerceRU ">Внедрение в ecommerce</li>
            
                <li class="drop-menu ecommerceRU " data-order="1">
                    <a href="/ru/ecommerce/main-page">Главная страница</a>
                </li>
            
                <li class="drop-menu ecommerceRU " data-order="1">
                    <a href="/ru/ecommerce/index">Обзор</a>
                </li>
            
                <li class="drop-menu ecommerceRU " data-order="2">
                    <a href="/ru/ecommerce/listing">Категория товаров</a>
                </li>
            
                <li class="drop-menu ecommerceRU " data-order="3">
                    <a href="/ru/ecommerce/search">Результаты поиска</a>
                </li>
            
                <li class="drop-menu ecommerceRU " data-order="4">
                    <a href="/ru/ecommerce/product">Карточка товара</a>
                </li>
            
                <li class="drop-menu ecommerceRU " data-order="5">
                    <a href="/ru/ecommerce/cart">Корзина</a>
                </li>
            
                <li class="drop-menu ecommerceRU " data-order="6">
                    <a href="/ru/ecommerce/checkout">Страница оформления заказа</a>
                </li>
            
                <li class="drop-menu ecommerceRU " data-order="7">
                    <a href="/ru/ecommerce/transaction">Спасибо за покупку</a>
                </li>
            
                <li class="drop-menu ecommerceRU " data-order="8">
                    <a href="/ru/ecommerce/content">Текстовая страница</a>
                </li>
            
        
        
    
        
        
        
        
        
            <li class="nav-header digitalDataRU ">Список переменных</li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/wishlist">wishlist</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/cart">cart</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/changes">changes</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/context">context</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/events">events</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/listing">listing</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/page">page</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/product">product</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/recommendation">recommendation</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/standard-version">version</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/transaction">transaction</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/user">user</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/website">website</a>
                </li>
            
                <li class="drop-menu digitalDataRU " data-order="1">
                    <a href="/ru/digitaldata/campaigns">campaigns</a>
                </li>
            
        
        
    
        
        
        
        
        
            <li class="nav-header eventsRU ">Список событий</li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/viewed-product">Viewed Product</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/added-payment-info">Added Payment Info</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/added-product-to-wishlist">Added Product to Wishlist</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/added-product">Added Product</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/clicked-campaign">Clicked Campaign</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/clicked-product">Clicked Product</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/completed-checkout-step">Completed Checkout Step</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/completed-transaction">Completed Transaction</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/logged-in">Logged In</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/received-voucher">Received Voucher</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/refunded-transaction">Refunded Transaction</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/registered">Registered</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/removed-product-from-wishlist">Removed Product from Wishlist</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/removed-product">Removed Product</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/searched-products">Searched Products</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/started-order">Started Order</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/subscribed">Subscribed</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/unsubscribed">Unsubscribed</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/updated-cart">Updated Cart</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/updated-profile-info">Updated Profile Info</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/viewed-campaign">Viewed Campaign</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/viewed-cart">Viewed Cart</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/viewed-checkout-step">Viewed Checkout Step</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/viewed-experiment">Viewed Experiment</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/viewed-page">Viewed Page</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/viewed-product-detail">Viewed Product Detail</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/viewed-product-listing">Viewed Product Listing</a>
                </li>
            
                <li class="drop-menu eventsRU " data-order="2">
                    <a href="/ru/events/achieved-experiment-goal">Achieved Experiment Goal</a>
                </li>
            
        
        
    
        
        
        
        
        
            <li class="nav-header integrationsRU ">Список интеграций</li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/yandex-metrica">Yandex Metrica</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/admitad">Admitad</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/citiads">Cityads</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/criteo">Criteo</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/ddmanager-streaming">SegmentStream Streaming</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/facebook">Facebook</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/gdeslon">GdeSlon</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/google-adwords">Google Adwords</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/google-analytics">Google Analytics</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/google-tag-manager">Google Tag Manager</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/linkprofit">LinkProfit</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/mindbox">Mindbox</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/mixmarket">Mixmarket</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/ofsys">Ofsys</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/onesignal">OneSignal</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/owox">OWOX</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/retail-rocket">Retail Rocket</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/rtb-house">RTB House</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/vkontakte">Vkontakte</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/weborama">Weborama</a>
                </li>
            
                <li class="drop-menu integrationsRU " data-order="1">
                    <a href="/ru/integrations/actionpay">Actionpay</a>
                </li>
            
        
        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class="divider"></li> first to break up the content. -->
</ul>


                    </div>

                    <div id="content" class="col-sm-9 col-md-7">
                        <div class="page-header">
    <h1>Настройки проекта
        
    </h1>
</div>

<p>В зависимости от особенностей архитектуры вашего сайта могут отличаться и настройки проекта. Если ваш сайт построен на технологии AJAX, или разные разделы сайта располагаются на разных поддоменах и в некоторых других случаях вам необходимо сделать ряд настроек.</p>

<h3 id="Навигация-по-странице">Навигация по странице</h3>
<hr />
<ul class="page-navigation">
  <li><a href="#intro">Введение</a></li>
  <li><a href="#sendViewedPageEvent">Автоматическая отправка события Viewed Page</a></li>
  <li><a href="#useCookieStorage">Использовать Cookie вместо LocalStorage для хранения данных</a></li>
  <li><a href="#sessionLength">Длина сессии в секундах</a></li>
  <li><a href="#websiteMaxWidth">Максимальная ширина сайта в пикселях</a></li>
  <li><a href="#pageLoadTimeout">Таймаут загрузки страницы в миллисекундах</a></li>
  <li><a href="#trackValidationErrors">Отслеживать ошибки валидации</a></li>
  <li><a href="#trackJsErrors">Отслеживать все ошибки JavaScript</a></li>
  <li><a href="#cookieConsent">Согласие на использование Cookies</a></li>
  <li><a href="#unpersistContextCampaignOnTransaction">Очищать context.campaign после "Completed Transaction"</a></li>
</ul>

<h3 id="Введение"><a name="intro"></a>Введение</h3>
<hr />
<p>Чтобы задать настройки:</p>
<ol>
  <li>Авторизуйтесь на сайте <a href="https://admin.segmentstream.com/">segmentstream.com</a></li>
  <li>Кликните на ссылку “настройки” в правом верхнем углу окна.</li>
  <li>Сделайте настройки согласно документации ниже</li>
  <li>Опубликуйте проект.</li>
</ol>

<p><img src="/img/settings.png" alt="" /></p>

<h3 id="Автоматическая-отправка-события-viewed-page"><a name="sendViewedPageEvent"></a>Автоматическая отправка события Viewed Page</h3>
<hr />
<p>Событие <code class="highlighter-rouge">Viewed Page</code> - это базовое событие. Оно необходимо для работы большинства сторонних систем. Вместе с событием Viewed Page в сторонние системы отправляются различные данные из объекта <code class="highlighter-rouge">digitalData</code>: <code class="highlighter-rouge">digitalData.page.type</code>, <code class="highlighter-rouge">digitalData.user.userId</code>, <code class="highlighter-rouge">digitalData.listing.categoryId</code> и многие другие.</p>

<blockquote>
  <p>Событие <code class="highlighter-rouge">Viewed Page</code>  должно быть добавлено в массив <code class="highlighter-rouge">digitalData.events</code> только после полного заполнения данными объекта <code class="highlighter-rouge">digitalData</code>.</p>
</blockquote>

<p>По умолчанию SegmentStream автоматически добавляет событие <code class="highlighter-rouge">Viewed Page</code> в массив <code class="highlighter-rouge">digitalData.events</code> в момент загрузки библиотеки <code class="highlighter-rouge">ddmanager.js</code>. Это происходит при каждой загрузке страницы.</p>

<p>Если вы добавляете событие <code class="highlighter-rouge">Viewed Page</code> в массив <code class="highlighter-rouge">digitalData.events</code> самостоятельно из кода сайта, делайте это только после заполнения объекта digitalData всеми переменными. В этом случае выключите тумблер “Автоматической отправки события Viewed Page”.</p>

<h3 id="Использовать-cookie-вместо-localstorage-для-хранения-данных"><a name="useCookieStorage"></a>Использовать Cookie вместо LocalStorage для хранения данных</h3>
<hr />
<p>SegmentStream позволяет на основе событий и переменных объекта <code class="highlighter-rouge">digitalData</code> создавать новые переменные и сохранять их на определенный срок. Например: вам необходимо передать в google analytics количество просмотров карточек товаров перед покупкой. Подробнее о сохранении переменных читайте в разделе <a href="/ru/for-analyst/events/">Переменные</a>.</p>

<p>По умолчанию значение любой переменной сохраняется в <a href="https://www.w3schools.com/html/html5_webstorage.asp">LocalStorage</a> браузера посетителя в виде строки. LocalStorage поддерживается всеми современными браузерами. В отличие от Cookie, LocalStorage является более безопасным хранилищем, вмещает до 5 мб, и информация никогда не отправляется на сервер.</p>

<p>Однако LocalStorage хранит информацию в рамках одного домена. Это значит, что вы не можете получить доступ к информации со страниц поддомена.</p>

<blockquote>
  <p>Если разные разделы вашего сайта расположены на поддоменах - используйте Cookie вместо LocalStorage</p>
</blockquote>

<p>В качестве домена для установки cookie укажите домен верхнего уровня.
Например, ваш интернет-магазин расположен по адресу https://shop.ru, но корзина расположена по адресу https://cart.shop.ru. Чтобы со страниц корзины была доступна информация, сохраненная на страницах карточек товаров, необходимо использовать cookie с доменом shop.ru</p>

<blockquote>
  <p>Cookie хранят только 4кб. Обратите на это внимание при сохранении больших массивов или строк.</p>
</blockquote>

<h3 id="-Длина-сессии-в-секундах"><a name="sessionLength"></a> Длина сессии в секундах</h3>
<hr />
<p>SegmentStream имеет встроенное событие <code class="highlighter-rouge">Session Started</code>. Это событие автоматически добавляется в массив <code class="highlighter-rouge">digitalData.events</code> в случае, если у данного пользователя с момента любого другого события прошло больше заданного отрезка времени. По умолчанию этот отрезок времени (Длина сессии) равен одному часу или 3600 секунд.
Примеры:</p>
<ol>
  <li>Пользователь впервые попал на сайт. Одновременно с первым событием <code class="highlighter-rouge">Viewed Page</code> SegmentStream добавит событие <code class="highlighter-rouge">Session Started</code> в массив <code class="highlighter-rouge">digitalData.events</code>.</li>
  <li>Пользователь ходил по сайту, оставил вкладку браузера открытой и ушел на 2 часа. Пользователь вернулся к сайту и кликнул на баннер или перешел на другую страницу. В этот момент событие <code class="highlighter-rouge">Session Started</code> будет автоматически добавлено в массив <code class="highlighter-rouge">digitalData.events</code>.</li>
</ol>

<p>Это событие может вам понадобиться, если вы захотите обнулять или перезаписывать значение переменной в объекте digitalData в момент старта новой сессии.</p>

<blockquote>
  <p>Рекомендуем и в Google Analytics и в SegmentStream задать одинаковую длину сессии.</p>
</blockquote>

<h3 id="-Максимальная-ширина-сайта-в-пикселях"><a name="websiteMaxWidth"></a> Максимальная ширина сайта в пикселях</h3>
<hr />
<p>Если вы используете на сайте блок со слайдером баннеров, рекомендуем задать в поле настройки максимальную ширину окна вашего сайта. Эта настройка поможет правильно учитывать <a href="/ru/events/viewed-campaign">события показов баннеров</a>.</p>

<h3 id="-Таймаут-загрузки-страницы-в-миллисекундах"><a name="pageLoadTimeout"></a> Таймаут загрузки страницы в миллисекундах</h3>
<hr />
<p>SegmentStream попытается загрузить интеграции из блока “После загрузки сайта” (подробнее на странице <a href="/ru/for-analyst/priorities">Приоритеты</a>) даже если не наступило событие <code class="highlighter-rouge">onload</code> для <code class="highlighter-rouge">window</code>.</p>

<h3 id="-Отслеживать-ошибки-валидации"><a name="trackValidationErrors"></a> Отслеживать ошибки валидации</h3>
<hr />
<p>SegmentStream имеет встроенный <a href="/ru/for-analyst/integrations#2">модуль отслеживания ошибок работы интеграций</a>. Данный модуль выводит в консоль разработчика информацию обо всех данных, отправляемых в сторонние системы. Если вы включите отслеживание ошибок валидации, то каждый раз при возникновении ошибки в работе интеграции у любого из посетителей сайта, SegmentStream будет автоматически добавлять это событие в массив <code class="highlighter-rouge">digitalData.events</code>. Теперь это событие может быть отправлено в любую систему статистики для последующего анализа причин возникновения ошибки.</p>

<p>Если у вас настроена интеграция с <a href="/ru/integrations/google-analytics">Google Analytics</a>, информацию об ошибках валидации вы найдете в отчетах по событиям.</p>

<h3 id="-Отслеживать-все-ошибки-javascript"><a name="trackJsErrors"></a> Отслеживать все ошибки JavaScript</h3>
<hr />
<p>SegmentStream также умеет перехватывать сообщения о возникновении любых JavaScript-ошибок на вашем сайте. Обычно на сайтах происходят тысячи ошибок: не подгружаются библиотеки сторонних систем, ошибки в скриптах разработчиков, непредвиденные действия пользователей и так далее. Все эти ошибки могут быть переданы в Google Analytics с хитами типа <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/exceptions">exceptions</a>. Построив кастомный отчет в интерфейсе Google Analytics вы сможете найти страницы и условия при которых случаются ошибки.</p>

<p><img src="/img/settings.1.png" alt="" />
Пример настройки отчета в интерфейсе Google Analytics</p>

<h3 id="-Согласие-на-использование-cookies"><a name="cookieConsent"></a> Согласие на использование Cookies</h3>
<hr />
<p>SegmentStream поддерживает общий регламент по защите данных (GDPR).
По умолчанию работает политика None, которая не предусматривает защиту данных.
Чтобы установить поддержку регламента по защите данных вам необходимо произвести следующие действия:</p>

<ol>
  <li>Убедиться, что на сайте установлена самая последняя версия <a href="/ru/for-developer/snippet">сниппета SegmentStream</a>.</li>
  <li>Выбрать политику в настройках проекта по адресу <a href="https://admin.segmentstream.com/">https://admin.segmentstream.com/</a> (см скриншот в разделе введение).</li>
  <li>Добавить после сниппета обработчик события для изменения согласия пользователя на обработку своих данных:</li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code>ddManager.on('ready', function() {
  // в переменной consent будет решение
  // пользователя по обработке своих данных:
  // undefined - пользователь не принял решение
  // true - пользователь согласен на обработку данных
  // false - пользователь не согласен на обработку данных
  var consent = ddManager.getConsent();

  if (consent === undefined) {
    // показать всплывающее окно или баннер
    // для получения согласия пользователя
    // Если используется регламент Opt-in / Opt-out
    // нужно добавить обработчики событий принятия или отказа,
    // вызывающие метод ddManager.setConsent()
  }
});
</code></pre>
</div>

<p>В защите данных предусматривается 4 вида регламентов:</p>

<ul>
  <li><strong>None</strong></li>
  <li><strong>Info</strong></li>
  <li><strong>Opt-in</strong></li>
  <li><strong>Opt-out</strong></li>
</ul>

<p><strong>None</strong> - значение по умолчанию. При значении <strong>None</strong> SegmentStream отправляет пользовательские данные во все подключенные системы.</p>

<p><strong>Info</strong> - режим информирования. В данном режиме, при первичном посещении сайта, необходимо показать пользователю баннер или всплывающее окно с информацией о том, что данный сайт собирает пользовательские данные. SegmentStream автоматически вызывает функцию <code class="highlighter-rouge">ddManager.setConsent(true);</code>, которая передаст в переменную <code class="highlighter-rouge">digitalData.consent</code> значение <code class="highlighter-rouge">true</code> после совершения пользователем любого из действий: нажатие клавиши на клавиатуре, клик, скролл, проведение пальцем по сенсорному экрану на области страницы сайта. <strong>Начиная со следующего события <code class="highlighter-rouge">Viewed Page</code></strong>, SegmentStream станет отправлять пользовательские данные во все подключенные системы.</p>

<p><strong>Opt-in</strong> - режим, требующий явного согласие пользователя на передачу данных сторонним системам. В данном режиме, при первичном посещении сайта, необходимо показать пользователю баннер или всплывающее окно с информацией о том, что данный сайт собирает пользовательские данные.</p>
<ul>
  <li>Если пользователь согласен, он нажимает на кнопку принятия, после чего код сайта вызывает функцию <code class="highlighter-rouge">ddManager.setConsent(true);</code>, которая передаст в переменную <code class="highlighter-rouge">digitalData.cookieConsent</code> значение <code class="highlighter-rouge">true</code>. <strong>Начиная со следующего события <code class="highlighter-rouge">Viewed Page</code></strong>, SegmentStream станет отправлять пользовательские данные во все подключенные системы.</li>
  <li>Если пользователь не согласен, код сайта вызывает функцию <code class="highlighter-rouge">ddManager.setConsent(false);</code>, которая передаст в переменную <code class="highlighter-rouge">digitalData.cookieConsent</code> значение <code class="highlighter-rouge">false</code>. SegmentStream не будет отправлять пользовательские данные ни в одну из подключенных систем.</li>
</ul>

<p><strong>Opt-out</strong> - режим, требующий явного отказа пользователя от передачи данных сторонним системам. При первичном посещении сайта SegmentStream отправляет пользовательские данные во все подключенные системы. При этом, необходимо сразу показать пользователю баннер с информацией о том, что пользовательские данные собираются.</p>
<ul>
  <li>Если пользователь согласен, он нажимает на кнопку принятия. После нажатия код сайта вызывает функцию <code class="highlighter-rouge">ddManager.setConsent(true);</code>, которая передаст в переменную <code class="highlighter-rouge">digitalData.cookieConsent</code> значение <code class="highlighter-rouge">true</code>. SegmentStream продолжит отправлять пользовательские данные во все подключенные системы.</li>
  <li>Если пользователь не согласен, он нажимает на кнопку отказа. После нажатия код сайта вызывает функцию <code class="highlighter-rouge">ddManager.setConsent(false);</code>, которая передаст в переменную <code class="highlighter-rouge">digitalData.cookieConsent</code> значение <code class="highlighter-rouge">false</code>. С этого момента SegmentStream не будет отправлять пользовательские данные ни в одну из подключенных систем.</li>
</ul>

<hr />

<blockquote>
  <p>В режимах <strong>Info</strong> и <strong>Opt-in</strong>, SegmentStream не загружает библиотеки интеграций. После получения акцепта пользователя SegmentStream ожидает следующего события <strong>Viewed Page</strong>, поэтому SPA-приложения должны сами сгенерировать событие <strong>Viewed Page</strong> после согласия пользователя.</p>
</blockquote>

<p>На сайте <a href="https://demo.segmentstream.com">https://demo.segmentstream.com</a> реализован пример защиты данных по регламенту <strong>Opt-in</strong>.</p>

<h3 id="-Очищать-contextcampaign-после-completed-transaction"><a name="unpersistContextCampaignOnTransaction"></a> Очищать context.campaign после “Completed Transaction”</h3>
<hr />
<p>При каждом переходе на сайт, SegmentStream автоматически считывает utm_метки из url перехода, заполняет данными объект <code class="highlighter-rouge">context.campaign</code>. Подробнее читайте в разделе <a href="/ru/digitaldata/context#7">context</a>.
По-умолчанию, содержание объекта <code class="highlighter-rouge">context.campaign</code> хранится до загрузки любого url сайта с новыми utm_метками или до наступления события <code class="highlighter-rouge">Completed Transaction</code>.
Вы можете включить или отключить очистку объекта <code class="highlighter-rouge">context.campaign</code> с помощью данного переключателя.</p>


                    </div>
                
            </div>
            <button id="myBtn" title="Go to top"></button>
        </div>
        <div id="footer">
            <div class="questionaire">
    <div class="row step1">
        <div class="col-sm-6 question">
            
            Эта статья была для Вас полезна?
            
        </div>
        <div class="col-sm-6 answer">
            <div class="button-questionaire">
                ДА
            </div>
            <div class="button-questionaire">
                НЕТ
            </div>
        </div>
    </div>
    <div class="row step2">
        <div class="col-xs-12">
            
            Спасибо за отзыв!
            
        </div>
    </div>
</div>
<a href="/"><img src="/img/segmentstream-logo.png" height="47" alt=SegmentStream documentation class="ddm-logo-footer"></a>
<p class="copyright">Copyright © 2019 "SegmentStream" Все права защищены.</p>

        </div>
        <!-- SegmentStream snippet -->
        <script type="text/javascript">
        (function(h,d){d=d||"cdn.segmentstream.com";var a=window.ddManager=window.ddManager||[];window.ddListener=window.ddListener||[];var b=window.digitalData=window.digitalData||{};b.events=b.events||[];b.changes=b.changes||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("SegmentStream snippet included twice.");else{a.invoked=!0;a.methods="initialize addIntegration persist unpersist on once off setConsent".split(" ");a.factory=function(k){return function(){var c=Array.prototype.slice.call(arguments);
        c.unshift(k);a.push(c);return a}};for(b=0;b<a.methods.length;b++){var f=a.methods[b];a[f]=a.factory(f)}a.load=function(a){var c=document.createElement("script");c.type="text/javascript";c.charset="utf-8";c.async=!0;c.src=a;a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(c,a)};a.loadProject=function(b){var c=window.location.search;if(0<=c.indexOf("ddm_test_mode=1"))try{var e=!0;window.localStorage.setItem("_ddm_test_mode","1")}catch(g){}else if(0<=c.indexOf("ddm_test_mode=0"))try{e=
        !1,window.localStorage.removeItem("_ddm_test_mode")}catch(g){}else try{e="1"===window.localStorage.getItem("_ddm_test_mode")}catch(g){}e?a.load(window.DDMANAGER_TESTMODE_INIT_URL||"https://api.segmentstream.com/v1/ddm-initialization/"+b+".js"):a.load(window.DDMANAGER_INIT_URL||"https://"+d+"/project/"+b+".js")};a.CDN_DOMAIN=d;a.SNIPPET_VERSION="1.0.11";a.loadProject(h)}})("975f9b27-a262-4758-9019-0bf81f566d68");
        </script>
        <!-- //SegmentStream snippet -->
    </body>
</html>
